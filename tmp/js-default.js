$(function(){$('.dropdown').on('show.bs.dropdown',function(){$(this).find(".dropdown-menu").slideDown('slow');});$('.dropdown').on('hide.bs.dropdown',function(){$(this).find(".dropdown-menu").slideUp('slow');});$("#search").click(function(event){var categories=["title","category","seeds","size"];if($("#head").children().length==0){$("#progress_bar").toggleClass('hidden');$("#progress_bar").children(0).children(0).css("width","100%").attr('aria-valuenow','100').parent(0).fadeOut(1000).promise().done(function(){$(this).children(0).css("width","0%").attr('aria-valuenow','0');});$("#search_row").fadeIn(100).children(0).css("padding-top","1cm");$("#head").toggleClass('hidden').append($("#search_row"));}else{$("#results").slideDown().toggleClass('hidden').promise().done(function(){$(this).children(0).children().remove();});$("#progress_bar").toggleClass('hidden');$("#progress_bar").children(0).children(0).css("width","100%").attr('aria-valuenow','100').parent(0).fadeOut(1000).promise().done(function(){$(this).children(0).css("width","0%").attr('aria-valuenow','0');});} $.ajax({url:"/search/"+($("#search_text").val())}).done(function(data){$.each(data,function(i,item){if(item["hash"]!=null){var elem="<tr onClick=\"download('"+item["hash"]+"')\">";$.each(item,function(i,item){if($.inArray(i,categories)!=-1) elem+=("<td>"+item+"</td>");});elem+="</tr>";$("#results").children(0).append(elem);}});$("#results").toggleClass('hidden');});$("#search_text").focus();});});$(document).keypress(function(e){if(e.which==13){$("#search").trigger('click');}else{$("#search_text").focus();}});function download(hash){console.log("download");$.ajax({url:'/download/'+hash,}).done(function(){var n=noty({layout:'top',theme:'relax',type:'success',text:'The torrent was started',dismissQueue:true,animation:{open:{height:'toggle'},close:{height:'toggle'},easing:'swing',speed:500},timeout:false,force:true,modal:false,maxVisible:5,killer:true,closeWith:['click'],callback:{onShow:function(){},afterShow:function(){setTimeout(function(){n.close();},2000);},onClose:function(){},afterClose:function(){},onCloseClick:function(){},},buttons:false});});}